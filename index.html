<!DOCTYPE html>

<head>
<title>Songlist</title>
<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
  crossorigin="anonymous"> 
</script>
</head>

<body>

<script>

  jsonSongList = [];

  $.getJSON('songlist.json', data => {
    genreshtml = "<option value='All' selected>All Genres</option>";
    genres = [];

    // save json data
    jsonSongList = data;

    // get all genres for form options
    data.forEach(song => { 
      song.genres.forEach(genre => {
        if (!genres.includes(genre)) genres.push(genre);
      })
    })
    // sort and add genre options to form select
    genres.sort();
    genres.forEach(genre => {
      genreshtml += "<option value='" + genre + "'>" + genre + "</option>";
    })
    document.getElementById("genres").innerHTML = genreshtml;

    // display all songs, since no filter is selected
    displaySongs();
  });

  
  function displaySongs() {
    genre = document.filter.genres.value;
    songshtml = "<tr><th>TITLE</th><th>ARTIST</th><th>RELEASE YEAR</th><th>GENRE</th></tr>";

    // filter songs by genre and display in user friendly manner
    jsonSongList.forEach(song => { 
      // skip current song if there is a genre filter applied and the song 
      // doesn't have the selected genre
      if (genre != "All" && !song.genres.includes(genre)) return;
      
      songshtml += "<tr><td>" + song.title + "</td>";
      songshtml += "<td>" + song.artist + "</td>";
      songshtml += "<td>" + song.year + "</td>";
      songshtml += "<td>";

      song.genres.forEach((genre, index) =>  {
        if (index + 1 == song.genres.length) songshtml += genre;
        else songshtml += genre + ", ";
      })
      songshtml += "</td></tr>"
    })

    // add list of songs to "songs" div
    document.getElementById("songs").innerHTML = songshtml;
  }

  // function displaySongs() {
  //   genre = document.filter.genres.value;
  //   songshtml = "";

  //   // filter songs by genre and display in user friendly manner
  //   jsonSongList.forEach(song => { 
  //     // skip current song if there is a genre filter applied and the song 
  //     // doesn't have the selected genre
  //     if (genre != "All" && !song.genres.includes(genre)) return;
      
  //     songshtml += song.title + "<br />";
  //     songshtml += song.artist + "<br />";
  //     songshtml += "Release Year: " + song.year + "<br />";
  //     songshtml += "Genres: ";

  //     song.genres.forEach((genre, index) =>  {
  //       if (index + 1 == song.genres.length) songshtml += genre + "<br />";
  //       else songshtml += genre + ", ";
  //     })
  //     songshtml += "<br />"
  //   })

  //   // add list of songs to "songs" div
  //   document.getElementById("songs").innerHTML = songshtml;
  // }

</script>

<form name="filter">
  <select id="genres"></select>
  <input type="button" id="submit" value="Filter" onclick="displaySongs()">
</form>

<br />
<!-- <div id="songs"> -->
  <table id="songs">
    
  </table>
<!-- </div> -->

</body>
</html>